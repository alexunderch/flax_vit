
  0%|                                                                                                                                                                                                                                                       | 0/3 [00:00<?, ?it/s]
(2, 224, 224, 3)
(2, 224, 224, 3)
(2, 224, 224, 3)
(2, 224, 224, 3)
  0%|                                                                                                                                                                                                                                                       | 0/3 [01:26<?, ?it/s]
Traceback (most recent call last):
  File "/home/alex_ch/Documents/flax_vit/vit/nn/test_training.py", line 132, in <module>
    test_full_training()
  File "/home/alex_ch/Documents/flax_vit/vit/nn/test_training.py", line 123, in test_full_training
    full_trainining(
  File "/home/alex_ch/Documents/flax_vit/vit/nn/train_main.py", line 78, in full_trainining
    state, metrics = train_step(
  File "/home/alex_ch/flax_env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/alex_ch/flax_env/lib/python3.9/site-packages/jax/_src/api.py", line 606, in cache_miss
    out_flat = xla.xla_call(
  File "/home/alex_ch/flax_env/lib/python3.9/site-packages/jax/core.py", line 1939, in bind
    return call_bind(self, fun, *args, **params)
  File "/home/alex_ch/flax_env/lib/python3.9/site-packages/jax/core.py", line 1955, in call_bind
    outs = top_trace.process_call(primitive, fun_, tracers, params)
  File "/home/alex_ch/flax_env/lib/python3.9/site-packages/jax/core.py", line 701, in process_call
    return primitive.impl(f, *tracers, **params)
  File "/home/alex_ch/flax_env/lib/python3.9/site-packages/jax/_src/dispatch.py", line 234, in _xla_call_impl
    compiled_fun = xla_callable(fun, device, backend, name, donated_invars,
  File "/home/alex_ch/flax_env/lib/python3.9/site-packages/jax/linear_util.py", line 309, in memoized_fun
    ans = call(fun, *args)
  File "/home/alex_ch/flax_env/lib/python3.9/site-packages/jax/_src/dispatch.py", line 342, in _xla_callable_uncached
    return lower_xla_callable(fun, device, backend, name, donated_invars, False,
  File "/home/alex_ch/flax_env/lib/python3.9/site-packages/jax/_src/dispatch.py", line 978, in compile
    self._executable = XlaCompiledComputation.from_xla_computation(
  File "/home/alex_ch/flax_env/lib/python3.9/site-packages/jax/_src/dispatch.py", line 1136, in from_xla_computation
    compiled = compile_or_get_cached(backend, xla_computation, options,
  File "/home/alex_ch/flax_env/lib/python3.9/site-packages/jax/_src/dispatch.py", line 1054, in compile_or_get_cached
    return backend_compile(backend, serialized_computation, compile_options,
  File "/home/alex_ch/flax_env/lib/python3.9/site-packages/jax/_src/profiler.py", line 313, in wrapper
    return func(*args, **kwargs)
  File "/home/alex_ch/flax_env/lib/python3.9/site-packages/jax/_src/dispatch.py", line 994, in backend_compile
    return backend.compile(built_c, compile_options=options)
KeyboardInterrupt