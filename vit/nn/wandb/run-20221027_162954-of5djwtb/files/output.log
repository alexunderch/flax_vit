  0%|                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]INFO:root:training epoch 1
INFO:root:evaluating epoch 1
2022-10-27 16:29:55,557 - root - INFO - training epoch 1
2022-10-27 16:29:55,557 - root - INFO - evaluating epoch 1
  0%|                                                                                                                                                                                                                                                       | 0/1 [17:52<?, ?it/s]
Traceback (most recent call last):
  File "/home/alex_ch/Documents/flax_vit/vit/nn/test_training.py", line 130, in <module>
    test_full_training()
  File "/home/alex_ch/Documents/flax_vit/vit/nn/test_training.py", line 121, in test_full_training
    full_trainining(
  File "/home/alex_ch/Documents/flax_vit/vit/nn/train_main.py", line 120, in full_trainining
    state = flax.jax_utils.replicate(eval_state),
  File "/home/alex_ch/flax_env/lib/python3.9/site-packages/flax/jax_utils.py", line 56, in replicate
    return jax.device_put_replicated(tree, devices)
  File "/home/alex_ch/flax_env/lib/python3.9/site-packages/jax/_src/api.py", line 2961, in device_put_replicated
    return tree_map(_device_put_replicated, x)
  File "/home/alex_ch/flax_env/lib/python3.9/site-packages/jax/_src/tree_util.py", line 200, in tree_map
    return treedef.unflatten(f(*xs) for xs in zip(*all_leaves))
  File "/home/alex_ch/flax_env/lib/python3.9/site-packages/jax/_src/tree_util.py", line 200, in <genexpr>
    return treedef.unflatten(f(*xs) for xs in zip(*all_leaves))
  File "/home/alex_ch/flax_env/lib/python3.9/site-packages/jax/_src/api.py", line 2950, in _device_put_replicated
    rest_bufs = [buf.copy_to_device(d) for d in devices[1:]]
  File "/home/alex_ch/flax_env/lib/python3.9/site-packages/jax/_src/api.py", line 2950, in <listcomp>
    rest_bufs = [buf.copy_to_device(d) for d in devices[1:]]
KeyboardInterrupt